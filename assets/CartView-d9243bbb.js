import{_ as b,o,c as l,d as t,F as _,f,g as h,t as c,b as g,h as v,v as C}from"./index-f40caf4c.js";const{VITE_APP_URL:d,VITE_APP_PATH:i}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"2259buyer",BASE_URL:"/VueTraining_w6/",MODE:"production",DEV:!1,PROD:!0},I={data(){return{loadingStatus:{loadingItem:""},products:[],productID:"",carts:{},finalTotal:"",loadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""},visible:!1}},methods:{openModal(e){this.productID=e},getCartData(){this.$http.get(`${d}/v2/api/${i}/cart`).then(e=>{this.carts=e.data.data.carts,this.finalTotal=e.data.data.final_total}).catch(e=>{alert(e.response.data.message)})},updateCart(e){const{product_id:a,qty:p}=e,m={product_id:a,qty:p};this.loadingItem=e.id,this.$http.put(`${d}/v2/api/${i}/cart/${e.id}`,{data:m}).then(n=>{alert(n.data.message),this.loadingItem="",this.getCartData()}).catch(n=>{alert(n.response.data.message)})},cleanAllCart(){this.$http.delete(`${d}/v2/api/${i}/carts`).then(e=>{alert(e.data.message),this.getCartData()}).catch(e=>{alert(e.response.data.message)})},deleteOneCart(e){this.loadingItem=e,this.$http.delete(`${d}/v2/api/${i}/cart/${e}`).then(a=>{alert(a.data.message),this.loadingItem="",this.getCartData()}).catch(a=>{alert(a.response.data.message)})},createOrder(){console.log("createOrder");const e=this.form;this.$http.post(`${d}/v2/api/${i}/order`,{data:e}).then(a=>{alert(a.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(a=>{alert(a.response.data.message)})}},mounted(){this.getCartData(),this.visible=!0}},x={class:"text-end"},y={class:"table align-middle"},$=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價")])],-1),D=["onClick","disabled"],T={key:0,class:"fas fa-spinner fa-pulse"},V={key:0,class:"text-success"},P={class:"input-group input-group-sm"},A={class:"input-group mb-3"},k=["onUpdate:modelValue","onBlur","disabled"],E={class:"input-group-text",id:"basic-addon2"},B={class:"text-end"},O=t("td",{colspan:"3",class:"text-end"},"總計",-1),U={class:"text-end"};function w(e,a,p,m,n,r){return o(),l(_,null,[t("div",x,[t("button",{class:"btn btn-outline-danger",type:"button",onClick:a[0]||(a[0]=(...s)=>r.cleanAllCart&&r.cleanAllCart(...s))},"清空購物車")]),t("table",y,[$,t("tbody",null,[n.carts?(o(!0),l(_,{key:0},f(n.carts,s=>(o(),l("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:u=>r.deleteOneCart(s.id),disabled:s.id===n.loadingItem},[n.loadingItem===s.id?(o(),l("i",T)):h("",!0),g(" x ")],8,D)]),t("td",null,[g(c(s.product.title)+" ",1),s.coupon?(o(),l("div",V," 已套用優惠券 ")):h("",!0)]),t("td",null,[t("div",P,[t("div",A,[v(t("input",{"onUpdate:modelValue":u=>s.qty=u,onBlur:u=>r.updateCart(s),disabled:s.id===n.loadingItem,min:"1",type:"number",class:"form-control"},null,40,k),[[C,s.qty,void 0,{number:!0}]]),t("span",E,c(s.product.unit),1)])])]),t("td",B,c(s.product.price),1)]))),128)):h("",!0)]),t("tfoot",null,[t("tr",null,[O,t("td",U,c(n.finalTotal),1)])])])],64)}const R=b(I,[["render",w]]);export{R as default};
